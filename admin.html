<html>
  <head>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="no">
    <meta name = "viewport" content = "initial-scale = 1, user-scalable = no">
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <link rel="stylesheet" href="mdl/material.css">
    <link rel="stylesheet" href="style.css">
    <script src="mdl/material.min.js"></script>
  </head>
  <body>
    <header class="demo-header mdl-layout__header mdl-layout__header--scroll mdl-color--grey-100 mdl-color-text--grey-800">
      <div class="mdl-layout__header-row" style="padding: 0 40px 0 30px;">
        <div class="mdl-textfield mdl-js-textfield">
            <input class="mdl-textfield__input" id="product" type="text">
            <label class="mdl-textfield__label" for="sample1">Add custom product...</label>
        </div>

        <button class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--colored" id="submit" style="margin-left: 20px;">
          SUBMIT
        </button>

        <div class="mdl-layout-spacer"></div>
        <button id="fetch-btn" class="mdl-button mdl-js-button mdl-button--icon" style="margin-right:20px;">
          <i class="material-icons">refresh</i>
        </button>
        <button id="demo-menu-lower-right" class="mdl-button mdl-js-button mdl-button--icon" style="margin-right:20px;">
          <i class="material-icons">shopping_cart</i>
        </button>

        <ul id="cart-view" class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect"
            for="demo-menu-lower-right">
        </ul>

        <button class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect" id="finish">
          FINISHED SHOPPING
        </button>
      </div>
    </header>


      <div class="mdl-grid">
        <div class="mdl-cell mdl-cell--6-col" id="products">
          <h3>Select a category...</h3>
        </div>

        <div class="mdl-cell mdl-cell--6-col">

          <div class="demo-card-image mdl-card mdl-shadow--2dp" data-category="Meat" style="background: url('images/meat.jpg') center / cover;float:left; margin: 10px;width: 45%;">
            <div class="mdl-card__title mdl-card--expand"></div>
            <div class="mdl-card__actions">
              <span class="demo-card-image__filename">Kød</span>
            </div>
          </div>
          <div class="demo-card-image mdl-card mdl-shadow--2dp" data-category="Vegetables" style="background: url('images/veg.jpg') center / cover;float:left; margin: 10px;width: 45%;">
            <div class="mdl-card__title mdl-card--expand"></div>
            <div class="mdl-card__actions">
              <span class="demo-card-image__filename">Grøntsager</span>
            </div>
          </div>
          <div class="demo-card-image mdl-card mdl-shadow--2dp" data-category="Fruit" style="background: url('images/fruits.jpg') center / cover;float:left; margin: 10px;width: 45%;">
            <div class="mdl-card__title mdl-card--expand"></div>
            <div class="mdl-card__actions">
              <span class="demo-card-image__filename">Frugt</span>
            </div>
          </div>
          <div class="demo-card-image mdl-card mdl-shadow--2dp" data-category="Dry" style="background: url('images/pasta.jpg') center / cover;float:left; margin: 10px;width: 45%;">
            <div class="mdl-card__title mdl-card--expand"></div>
            <div class="mdl-card__actions">
              <span class="demo-card-image__filename">Tørvarer</span>
            </div>
          </div>
          <div class="demo-card-image mdl-card mdl-shadow--2dp" data-category="Dairy" style="background: url('images/dairy.jpg') center / cover;float:left; margin: 10px;width: 45%;">
            <div class="mdl-card__title mdl-card--expand"></div>
            <div class="mdl-card__actions">
              <span class="demo-card-image__filename">Majeri og Æg</span>
            </div>
          </div>
          <div class="demo-card-image mdl-card mdl-shadow--2dp" data-category="Bread" style="background: url('images/bread.jpg') center / cover;float:left; margin: 10px;width: 45%;">
            <div class="mdl-card__title mdl-card--expand"></div>
            <div class="mdl-card__actions">
              <span class="demo-card-image__filename">Brød</span>
            </div>
          </div>
          <div class="demo-card-image mdl-card mdl-shadow--2dp" data-category="Cans" style="background: url('images/can.jpg') center / cover;float:left; margin: 10px;width: 45%;">
            <div class="mdl-card__title mdl-card--expand"></div>
            <div class="mdl-card__actions">
              <span class="demo-card-image__filename">Konserves</span>
            </div>
          </div>
          <div class="demo-card-image mdl-card mdl-shadow--2dp" data-category="Sauces" style="background: url('images/sauce.jpg') center / cover;float:left; margin: 10px;width: 45%;">
            <div class="mdl-card__title mdl-card--expand"></div>
            <div class="mdl-card__actions">
              <span class="demo-card-image__filename">Sauces</span>
            </div>
          </div>
          <div class="demo-card-image mdl-card mdl-shadow--2dp" data-category="Oils" style="background: url('images/oil.jpg') center / cover;float:left; margin: 10px;width: 45%;">
            <div class="mdl-card__title mdl-card--expand"></div>
            <div class="mdl-card__actions">
              <span class="demo-card-image__filename">Olier og Dressing</span>
            </div>
          </div>

        </div>
      </div>


      <div id="demo-toast-example" class="mdl-js-snackbar mdl-snackbar">
        <div class="mdl-snackbar__text"></div>
        <button class="mdl-snackbar__action" type="button"></button>
      </div>

    <script type="text/javascript" src="node_modules/jquery/dist/jquery.min.js"></script>
    <script src="socket.io.js"></script>
    <script type="text/javascript">
      var socket = io();
      var snackbarContainer = document.querySelector('#demo-toast-example');

      var veglist = ['Kartofler', 'Tomater', 'Agurk', 'Løg'];
      var breadlist = ['Rugbrød', 'Franskbrød', 'Boller', 'Flute'];
      var meatlist = ['Hakket Oksekød', 'Hakket Svinekød', 'Hakket Kylling', 'Kyllingefillet', 'Bøf', 'Laks', 'Bacon'];
      var drylist = ['Ris', 'Pasta', 'Lasagneplader', 'Sukker', 'Mel'];
      var canlist = ['Flåede Tomater', 'Tomatpurre', 'Majs'];
      var saucelist = ['Ketchup', 'Remulade', 'Mayonaise', 'Sennep', 'Money Sauce', 'Rødvins Sauce'];
      var dairylist = ['Mælk', 'Æg', 'Fløde', 'Smør', 'Revet Ost', 'Mozzerella', 'Ost'];
      var fruitlist = ['Æbler', 'Bananer', 'Pærer', 'Ananas', 'Vindruger'];
      var oillist = ['Olivenolie', 'Rapsolie', 'Kokusolie', 'Balsamico'];

      $(".demo-card-image").click(function() {
        category = $(this).attr('data-category');
        var list;

        if(category == 'Vegetables'){ list = veglist;}
        if(category == 'Bread'){ list = breadlist;}
        if(category == 'Meat'){ list = meatlist;}
        if(category == 'Dry'){ list = drylist;}
        if(category == 'Cans'){ list = canlist;}
        if(category == 'Sauces'){ list = saucelist;}
        if(category == 'Dairy'){ list = dairylist;}
        if(category == 'Fruit'){ list = fruitlist;}
        if(category == 'Oils'){ list = oillist;}

        $("#products").html('');

        for (var i = 0; i < list.length; i++) {
          $("#products").append('<div class="mdl-list__item">\
            <span class="mdl-list__item-primary-content">\
              <span>'+list[i]+'</span>\
            </span>\
            <span class="mdl-list__item-secondary-content">\
              <button class="mdl-button mdl-js-button mdl-button--fab mdl-js-ripple-effect mdl-button--colored add-item-btn" data-product="'+list[i]+'">\
                <i class="material-icons">add</i>\
              </button>\
          </span></div>');
        }

        $(".add-item-btn").click(function(){
          product = $(this).attr('data-product');

          $.post('/list/add/'+product.toLowerCase());

          snackbarContainer.MaterialSnackbar.showSnackbar({message: product+' was added to the cart!'});

        });

      });

      $("#submit").click(function(){
        var product = $("#product").val();
        $.post('/list/add/'+product.toLowerCase());
        $("#product").val('').focus();
        snackbarContainer.MaterialSnackbar.showSnackbar({message: product+' was added to the cart!'});
      });

      $('#product').keypress(function (e) {
       var key = e.which;
       if(key == 13)  // the enter key code
        {
          $('#submit').click();
          return false;
        }
      });

      $('#fetch-btn').click(function() {
        $.get('/shoppinglist');
        snackbarContainer.MaterialSnackbar.showSnackbar({message: 'Latest shopping list was fetched'});
      });

      socket.on('adminshoppinglist', function(data){
        $("#cart-view").html('');
        for (var i = 0; i < data.length; i++) {
          if(data[i].checked == 'true'){
            $("#cart-view").append('<li disabled class="mdl-menu__item">'+data[i].name+'</li>');
          } else {
            $("#cart-view").append('<li class="mdl-menu__item">'+data[i].name+'</li>');
          }
        }

        $('.mdl-menu__item').click(function() {
          product = $(this).text();
          $.post('/list/add/'+product.toLowerCase());
          snackbarContainer.MaterialSnackbar.showSnackbar({message: product+' was added to the cart!'});
        });
      });

      $("#finish").click(function(){
        $("#cart-view").html('');
        $.post('/finish');

        snackbarContainer.MaterialSnackbar.showSnackbar({message: 'The cart has been cleared'});
      });
    </script>
  </body>
</html>
